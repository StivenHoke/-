## 进程概览

怎么理解进程？

进程是一个抽象概念，它让一个程序可以假设它独占一台机器。进程向程序提供“看上去”私有的，其他进程无法读写的内存系统（或地址空间），以及一颗“看上去”仅执行该程序的CPU

页表的作用？

xv6 使用页表（由硬件实现）来为每个进程提供其独有的地址空间。页表将虚拟地址映射到物理地址；

xv6为每个进程提供了不同的页表；

xv6使用结构体 struct proc;来维护一个进程的状态，其中最重要的是页表，内核栈，运行状态；

线程

每个进程都有一个运行线程（或简称为 *线程* ）来执行进程的指令。线程可以被暂时挂起，稍后再恢复运行。系统在进程之间切换实际上就是挂起当前运行的线程，恢复另一个进程的线程；

线程可以交替使用内核栈和用户栈，但当使用用户栈的时候，内核栈是空的。使用内核栈时，用户栈处于不活跃的状态；且注意内核栈的代码是用户无法使用的。

p->state 指示的进程的状态，新建，准备运行，运行，等待I/O，退出状态；等待I/O一般是由线程阻塞来完成的；

`p->pgdir`以x86 硬件要求的格式保存了进程的页表。该页表保存了进程内存的物理地址；xv6让分页硬件在运行时调用p->pgdir;

## 第一个地址空间

内核代码是如何运行起来的？

pc开机初始化自己->载入boot loader->载入xv6内核从entry开始运行->enrty的页表项0将虚拟地址映射到物理地址上0：0x400000->页表项512将内核指令和内核数据应该出现在高虚拟地址映射到了低物理地址处->entrypgdir指向内存的高地址处->entry跳转到内核c代码，并且在内存的高地址执行。

## 创建第一个进程
